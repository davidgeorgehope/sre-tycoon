<% content_for(:title) { "Leaderboard" } %>

<div class="text-center mb-20">
  <h2 style="color: var(--amber); font-size: 18px;" class="glow">üèÜ Hall of Fame</h2>
  <p style="color: var(--text-dim); font-size: 12px;">The VPs who made it. And those who didn't.</p>
</div>

<!-- IPO Winners -->
<div class="card">
  <div class="card-header">‚ñ∏ Successful IPOs</div>
  <% if @winners.any? %>
    <table>
      <thead>
        <tr>
          <th>#</th>
          <th>Company</th>
          <th>Scenario</th>
          <th>Sprints</th>
          <th>Revenue</th>
          <th>Uptime</th>
          <th>Score</th>
        </tr>
      </thead>
      <tbody>
        <% @winners.each_with_index do |score, i| %>
          <tr>
            <td class="<%= i < 3 ? "rank-#{i + 1}" : '' %>">
              <%= i == 0 ? 'ü•á' : i == 1 ? 'ü•à' : i == 2 ? 'ü•â' : "##{i + 1}" %>
            </td>
            <td style="color: var(--green);"><%= score.company_name %></td>
            <td><%= score.scenario %></td>
            <td><%= score.turns_to_completion %></td>
            <td>$<%= (score.final_revenue / 1_000_000.0).round(2) %>M</td>
            <td><%= score.final_uptime.round(2) %>%</td>
            <td style="color: var(--amber); font-weight: 600;">
              <%= score.final_score.to_s.reverse.scan(/.{1,3}/).join(',').reverse %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  <% else %>
    <div class="text-center" style="padding: 30px; color: var(--text-dim);">
      No IPOs yet. Be the first to ring the bell. üîî
    </div>
  <% end %>
</div>

<!-- Hall of Shame -->
<div class="card">
  <div class="card-header">‚ñ∏ Hall of Shame üíÄ</div>
  <% if @shame.any? %>
    <table>
      <thead>
        <tr>
          <th>Company</th>
          <th>Scenario</th>
          <th>Lasted</th>
          <th>Score</th>
          <th>When</th>
        </tr>
      </thead>
      <tbody>
        <% @shame.each do |score| %>
          <tr>
            <td style="color: var(--red);"><%= score.company_name %></td>
            <td><%= score.scenario %></td>
            <td><%= score.turns_to_completion %> sprints</td>
            <td><%= score.final_score.to_s.reverse.scan(/.{1,3}/).join(',').reverse %></td>
            <td style="color: var(--text-dim);"><%= score.completed_at&.strftime('%Y-%m-%d') %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  <% else %>
    <div class="text-center" style="padding: 30px; color: var(--text-dim);">
      No failures yet. Give it time. ü´†
    </div>
  <% end %>
</div>

<!-- Recent Games -->
<div class="card">
  <div class="card-header">‚ñ∏ Recent Games</div>
  <% if @recent.any? %>
    <table>
      <thead>
        <tr>
          <th>Company</th>
          <th>Result</th>
          <th>Sprints</th>
          <th>Score</th>
          <th>When</th>
        </tr>
      </thead>
      <tbody>
        <% @recent.each do |score| %>
          <tr>
            <td style="color: <%= score.won ? 'var(--green)' : 'var(--red)' %>;"><%= score.company_name %></td>
            <td><%= score.won ? 'üéâ IPO' : 'üíÄ Failed' %></td>
            <td><%= score.turns_to_completion %></td>
            <td><%= score.final_score.to_s.reverse.scan(/.{1,3}/).join(',').reverse %></td>
            <td style="color: var(--text-dim);"><%= score.completed_at&.strftime('%Y-%m-%d %H:%M') %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  <% else %>
    <div class="text-center" style="padding: 30px; color: var(--text-dim);">
      No games completed yet. Go play one!
    </div>
  <% end %>
</div>

<div class="text-center mt-20">
  <a href="<%= new_game_path %>" class="btn btn-lg">‚ñ∂ START NEW GAME</a>
</div>
